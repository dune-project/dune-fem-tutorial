{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "4fb6f82d",
   "metadata": {},
   "source": [
    "# Mean Curvature Flow (revisited)\n",
    "\n",
    "[As discussed before](mcf_nb.ipynb)\n",
    "we can simulate the shrinking of a sphere under mean curvature flow\n",
    "using a finite element approach based on\n",
    "the following time discrete approximation:\n",
    "\\begin{align}\n",
    "\\int_{\\Gamma^n} \\big( U^{n+1} - {\\rm id}\\big) \\cdot \\varphi +\n",
    "\\tau \\int_{\\Gamma^n} \\big(\n",
    "\\theta\\nabla_{\\Gamma^n} U^{n+1} + (1-\\theta) I \\big)\n",
    "\\colon\\nabla_{\\Gamma^n}\\varphi\n",
    "=0~.\n",
    "\\end{align}\n",
    "Here $U^n$ parametrizes $\\Gamma(t^{n+1})$ over\n",
    "$\\Gamma^n:=\\Gamma(t^{n})$,\n",
    "$I$ is the identity matrix, $\\tau$ is the time step and\n",
    "$\\theta\\in[0,1]$ is a discretization parameter.\n",
    "\n",
    "If the initial surface $\\Gamma^0$ is a sphere of radius $R_0$,\n",
    "the surface remains sphere and we have an exact formula for the evolution\n",
    "of the radius of the surface\n",
    "\n",
    "$$R(t) = \\sqrt{R_0^2 - 4t}.$$\n",
    "\n",
    "To compare the accuracy of the surface approximation we compute an\n",
    "average radius of the discrete surface in each time step $t^n$ using\n",
    "\n",
    "$$R_h^n = \\frac{ \\int_{\\Gamma^n} |x| }{ |\\Gamma^n| }.$$\n",
    "\n",
    "Computing $R_h^n$ requires a grid traversal and a number of calls to\n",
    "interface methods on each element. Doing this on the Python side has a\n",
    "potential performance impact which we investigate here by comparing a\n",
    "pure python implementation with a hybrid approach where computing $R_h^n$\n",
    "is implemented in C++ using the `dune.generator.algorithm` functionality."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "698f3a01",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-11-30T19:49:15.040886Z",
     "iopub.status.busy": "2025-11-30T19:49:15.040613Z",
     "iopub.status.idle": "2025-11-30T19:49:16.117111Z",
     "shell.execute_reply": "2025-11-30T19:49:16.116072Z"
    }
   },
   "outputs": [],
   "source": [
    "import time, io\n",
    "import numpy\n",
    "from matplotlib import pyplot as plt\n",
    "from matplotlib.ticker import ScalarFormatter\n",
    "\n",
    "from ufl import *\n",
    "import dune.ufl\n",
    "from dune.generator import algorithm\n",
    "import dune.geometry as geometry\n",
    "import dune.fem as fem\n",
    "\n",
    "def plot(ct, ct2):\n",
    "    fig, ax = plt.subplots()\n",
    "    plt.loglog(ct[0][:], ct[1][:],'*-', markersize=15, label='hybrid')\n",
    "    plt.loglog(ct2[0][:], ct2[1][:],'*-', markersize=15, label='python')\n",
    "    plt.grid(True)\n",
    "    for axis in [ax.xaxis, ax.yaxis]:\n",
    "        axis.set_major_formatter(ScalarFormatter())\n",
    "        axis.set_minor_formatter(ScalarFormatter())\n",
    "    yticks = ax.yaxis.get_minor_ticks()\n",
    "    for t in yticks:\n",
    "        t.label1.set_visible(False)\n",
    "    xticks = ax.xaxis.get_minor_ticks()\n",
    "    for t in xticks:\n",
    "        t.label1.set_visible(False)\n",
    "    plt.yticks(numpy.append(ct[1], ct2[1]))\n",
    "    plt.xticks(ct[0])\n",
    "    plt.legend(loc=\"upper left\")\n",
    "    plt.xlabel('Number of Grid Elements (log)',fontsize=20)\n",
    "    plt.gcf().subplots_adjust(bottom=0.17, left=0.16)\n",
    "    plt.ylabel('Runtime in s (log)',fontsize=20)\n",
    "\n",
    "# polynomial order of surface approximation\n",
    "order = 2\n",
    "\n",
    "# initial radius\n",
    "R0 = 2.\n",
    "\n",
    "# end time\n",
    "endTime = 0.1"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f2151b7c",
   "metadata": {
    "lines_to_next_cell": 0
   },
   "source": [
    "Main function for calculating the mean curvature flow of a given surface.\n",
    "If first argument is `True` the radius of the computed surface is\n",
    "computed using an algorithm implemented in C++ otherwise the computation\n",
    "is done in Python."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "e4d355cc",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-11-30T19:49:16.119900Z",
     "iopub.status.busy": "2025-11-30T19:49:16.119373Z",
     "iopub.status.idle": "2025-11-30T19:49:16.126358Z",
     "shell.execute_reply": "2025-11-30T19:49:16.125144Z"
    }
   },
   "outputs": [],
   "source": [
    "def calcRadius(surface):\n",
    "    R,vol = 0, 0\n",
    "    for e in surface.elements:\n",
    "        rule = geometry.quadratureRule(e.type, 4)\n",
    "        for p in rule:\n",
    "            geo = e.geometry\n",
    "            weight = geo.volume * p.weight\n",
    "            R   += geo.toGlobal(p.position).two_norm * weight\n",
    "            vol += weight\n",
    "    return R/vol\n",
    "\n",
    "code = \"\"\"\n",
    "#include <dune/geometry/quadraturerules.hh>\n",
    "template< class Surface >\n",
    "double calcRadius( const Surface &surface ) {\n",
    "  double R = 0, vol = 0.;\n",
    "  for( const auto &entity : elements( surface ) ) {\n",
    "    const auto& rule = Dune::QuadratureRules<double, 2>::rule(entity.type(), 4);\n",
    "    for ( const auto &p : rule ) {\n",
    "      const auto geo = entity.geometry();\n",
    "      const double weight = geo.volume() * p.weight();\n",
    "      R   += geo.global(p.position()).two_norm() * weight;\n",
    "      vol += weight;\n",
    "    }\n",
    "  }\n",
    "  return R/vol;\n",
    "}\n",
    "\"\"\"\n",
    "switchCalcRadius = lambda use_cpp,surface: \\\n",
    "             algorithm.load('calcRadius', io.StringIO(code), surface) \\\n",
    "             if use_cpp else calcRadius"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c06950ae",
   "metadata": {
    "lines_to_next_cell": 0
   },
   "source": [
    "Timings for a number of different grid refinements is dumped to disk"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "4bf22ce4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-11-30T19:49:16.128737Z",
     "iopub.status.busy": "2025-11-30T19:49:16.128294Z",
     "iopub.status.idle": "2025-11-30T19:49:16.142550Z",
     "shell.execute_reply": "2025-11-30T19:49:16.141361Z"
    }
   },
   "outputs": [],
   "source": [
    "from dune.fem.view import geometryGridView as geoGridView\n",
    "from dune.fem.space import lagrange as solutionSpace\n",
    "from dune.fem.scheme import galerkin as solutionScheme\n",
    "def calculate(use_cpp, gridView):\n",
    "    # space on Gamma_0 to describe position of Gamma(t)\n",
    "    space = solutionSpace(gridView, dimRange=gridView.dimWorld, order=order)\n",
    "    u = TrialFunction(space)\n",
    "    v = TestFunction(space)\n",
    "    x = SpatialCoordinate(space)\n",
    "    positions = space.interpolate(x, name=\"position\")\n",
    "\n",
    "    # space for discrete solution on Gamma(t)\n",
    "    surface = geoGridView(positions)\n",
    "    space = solutionSpace(surface, dimRange=surface.dimWorld, order=order)\n",
    "    solution  = space.interpolate(x, name=\"solution\")\n",
    "\n",
    "    # set up model using theta scheme\n",
    "    theta = 0.5   # Crank-Nicolson\n",
    "\n",
    "    I = Identity(3)\n",
    "    dt = dune.ufl.Constant(0,\"dt\")\n",
    "\n",
    "    a = (inner(u - x, v) + dt * inner(theta*grad(u)\n",
    "        + (1 - theta)*I, grad(v))) * dx\n",
    "\n",
    "    scheme = solutionScheme(a == 0, space, solver=\"cg\")\n",
    "\n",
    "    Rexact = lambda t: numpy.sqrt(R0*R0 - 4.*t)\n",
    "    radius = switchCalcRadius(use_cpp,surface)\n",
    "\n",
    "    dt.value = 0.02\n",
    "\n",
    "    numberOfLoops = 3\n",
    "    times = numpy.zeros(numberOfLoops)\n",
    "    errors = numpy.zeros(numberOfLoops)\n",
    "    totalIterations = numpy.zeros(numberOfLoops, numpy.dtype(numpy.uint32))\n",
    "    gridSizes = numpy.zeros(numberOfLoops, numpy.dtype(numpy.uint32))\n",
    "    for i in range(numberOfLoops):\n",
    "        positions.interpolate(x * (R0/sqrt(dot(x,x))))\n",
    "        solution.interpolate(x)\n",
    "        t = 0.\n",
    "        error = abs(radius(surface)-Rexact(t))\n",
    "        iterations = 0\n",
    "        start = time.time()\n",
    "        while t < endTime:\n",
    "            info = scheme.solve(target=solution)\n",
    "            # move the surface\n",
    "            positions.assign(solution)\n",
    "            # store some information about the solution process\n",
    "            iterations += int( info[\"linear_iterations\"] )\n",
    "            t          += scheme.model.dt\n",
    "            error       = max(error, abs(radius(surface)-Rexact(t)))\n",
    "        print(\"time used:\", time.time() - start)\n",
    "        times[i] = time.time() - start\n",
    "        errors[i] = error\n",
    "        totalIterations[i] = iterations\n",
    "        gridSizes[i] = gridView.size(2)\n",
    "        if i < numberOfLoops - 1:\n",
    "            gridView.hierarchicalGrid.globalRefine(1)\n",
    "            dt.value /= 2\n",
    "    eocs = numpy.log(errors[0:][:numberOfLoops-1] / errors[1:]) / numpy.log(numpy.sqrt(2))\n",
    "    try:\n",
    "        import pandas as pd\n",
    "        keys = {'size': gridSizes, 'error': errors, \"eoc\": numpy.insert(eocs, 0, None), 'iterations': totalIterations}\n",
    "        table = pd.DataFrame(keys, index=range(numberOfLoops),columns=['size', 'error', 'eoc', 'iterations'])\n",
    "        print(table)\n",
    "    except ImportError:\n",
    "        print(\"pandas module not found so not showing table - ignored\")\n",
    "        pass\n",
    "    return gridSizes, times"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7e07af61",
   "metadata": {},
   "source": [
    "Compute the mean curvature flow evolution of a spherical surface. Compare\n",
    "computational time of a pure Python implementation and using a C++\n",
    "algorithm to compute the radius of the [surface](sphere.dgf) for verifying the\n",
    "algorithm."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "fafe4fae",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-11-30T19:49:16.144917Z",
     "iopub.status.busy": "2025-11-30T19:49:16.144699Z",
     "iopub.status.idle": "2025-11-30T19:49:33.414704Z",
     "shell.execute_reply": "2025-11-30T19:49:33.413723Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "time used: 0.19389843940734863\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "time used: 1.0439131259918213\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "time used: 4.077387809753418\n",
      "   size     error       eoc  iterations\n",
      "0   318  0.001060       NaN          76\n",
      "1   766  0.000605  1.619153         208\n",
      "2  1745  0.000275  2.275142         420\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "time used: 0.2952141761779785\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "time used: 1.5677783489227295\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "time used: 6.422018766403198\n",
      "   size     error       eoc  iterations\n",
      "0   318  0.001060       NaN          76\n",
      "1   766  0.000605  1.619153         208\n",
      "2  1745  0.000275  2.275142         420\n"
     ]
    }
   ],
   "source": [
    "# set up reference domain Gamma_0\n",
    "results = []\n",
    "from dune.alugrid import aluConformGrid as leafGridView\n",
    "gridView = leafGridView(\"sphere.dgf\", dimgrid=2, dimworld=3)\n",
    "results += [calculate(True, gridView)]\n",
    "\n",
    "gridView = leafGridView(\"sphere.dgf\", dimgrid=2, dimworld=3)\n",
    "results += [calculate(False, gridView)]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "71361ed8",
   "metadata": {},
   "source": [
    "Compare the hybrid and pure Python versions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "5f3adce9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-11-30T19:49:33.416656Z",
     "iopub.status.busy": "2025-11-30T19:49:33.416304Z",
     "iopub.status.idle": "2025-11-30T19:49:33.667163Z",
     "shell.execute_reply": "2025-11-30T19:49:33.666366Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/jpeg": "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",
      "text/plain": [
       "<Figure size 320x240 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plot(results[0],results[1])"
   ]
  }
 ],
 "metadata": {
  "jupytext": {
   "cell_metadata_filter": "-all"
  },
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.14.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}

{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "2bb7fa86",
   "metadata": {},
   "source": [
    "# Mean Curvature Flow (revisited)\n",
    "\n",
    "[As discussed before](mcf_nb.ipynb)\n",
    "we can simulate the shrinking of a sphere under mean curvature flow\n",
    "using a finite element approach based on\n",
    "the following time discrete approximation:\n",
    "\\begin{align}\n",
    "\\int_{\\Gamma^n} \\big( U^{n+1} - {\\rm id}\\big) \\cdot \\varphi +\n",
    "\\tau \\int_{\\Gamma^n} \\big(\n",
    "\\theta\\nabla_{\\Gamma^n} U^{n+1} + (1-\\theta) I \\big)\n",
    "\\colon\\nabla_{\\Gamma^n}\\varphi\n",
    "=0~.\n",
    "\\end{align}\n",
    "Here $U^n$ parametrizes $\\Gamma(t^{n+1})$ over\n",
    "$\\Gamma^n:=\\Gamma(t^{n})$,\n",
    "$I$ is the identity matrix, $\\tau$ is the time step and\n",
    "$\\theta\\in[0,1]$ is a discretization parameter.\n",
    "\n",
    "If the initial surface $\\Gamma^0$ is a sphere of radius $R_0$,\n",
    "the surface remains sphere and we have an exact formula for the evolution\n",
    "of the radius of the surface\n",
    "\n",
    "$$R(t) = \\sqrt{R_0^2 - 4t}.$$\n",
    "\n",
    "To compare the accuracy of the surface approximation we compute an\n",
    "average radius of the discrete surface in each time step $t^n$ using\n",
    "\n",
    "$$R_h^n = \\frac{ \\int_{\\Gamma^n} |x| }{ |\\Gamma^n| }.$$\n",
    "\n",
    "Computing $R_h^n$ requires a grid traversal and a number of calls to\n",
    "interface methods on each element. Doing this on the Python side has a\n",
    "potential performance impact which we investigate here by comparing a\n",
    "pure python implementation with a hybrid approach where computing $R_h^n$\n",
    "is implemented in C++ using the `dune.generator.algorithm` functionality."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "8284e5c3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-02T14:01:02.045739Z",
     "iopub.status.busy": "2025-12-02T14:01:02.045544Z",
     "iopub.status.idle": "2025-12-02T14:01:03.088599Z",
     "shell.execute_reply": "2025-12-02T14:01:03.087532Z"
    }
   },
   "outputs": [],
   "source": [
    "import time, io\n",
    "import numpy\n",
    "from matplotlib import pyplot as plt\n",
    "from matplotlib.ticker import ScalarFormatter\n",
    "\n",
    "from ufl import *\n",
    "import dune.ufl\n",
    "from dune.generator import algorithm\n",
    "import dune.geometry as geometry\n",
    "import dune.fem as fem\n",
    "\n",
    "def plot(ct, ct2):\n",
    "    fig, ax = plt.subplots()\n",
    "    plt.loglog(ct[0][:], ct[1][:],'*-', markersize=15, label='hybrid')\n",
    "    plt.loglog(ct2[0][:], ct2[1][:],'*-', markersize=15, label='python')\n",
    "    plt.grid(True)\n",
    "    for axis in [ax.xaxis, ax.yaxis]:\n",
    "        axis.set_major_formatter(ScalarFormatter())\n",
    "        axis.set_minor_formatter(ScalarFormatter())\n",
    "    yticks = ax.yaxis.get_minor_ticks()\n",
    "    for t in yticks:\n",
    "        t.label1.set_visible(False)\n",
    "    xticks = ax.xaxis.get_minor_ticks()\n",
    "    for t in xticks:\n",
    "        t.label1.set_visible(False)\n",
    "    plt.yticks(numpy.append(ct[1], ct2[1]))\n",
    "    plt.xticks(ct[0])\n",
    "    plt.legend(loc=\"upper left\")\n",
    "    plt.xlabel('Number of Grid Elements (log)',fontsize=20)\n",
    "    plt.gcf().subplots_adjust(bottom=0.17, left=0.16)\n",
    "    plt.ylabel('Runtime in s (log)',fontsize=20)\n",
    "\n",
    "# polynomial order of surface approximation\n",
    "order = 2\n",
    "\n",
    "# initial radius\n",
    "R0 = 2.\n",
    "\n",
    "# end time\n",
    "endTime = 0.1"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "37327fa1",
   "metadata": {
    "lines_to_next_cell": 0
   },
   "source": [
    "Main function for calculating the mean curvature flow of a given surface.\n",
    "If first argument is `True` the radius of the computed surface is\n",
    "computed using an algorithm implemented in C++ otherwise the computation\n",
    "is done in Python."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "c5539d46",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-02T14:01:03.091485Z",
     "iopub.status.busy": "2025-12-02T14:01:03.090983Z",
     "iopub.status.idle": "2025-12-02T14:01:03.097933Z",
     "shell.execute_reply": "2025-12-02T14:01:03.096694Z"
    }
   },
   "outputs": [],
   "source": [
    "def calcRadius(surface):\n",
    "    R,vol = 0, 0\n",
    "    for e in surface.elements:\n",
    "        rule = geometry.quadratureRule(e.type, 4)\n",
    "        for p in rule:\n",
    "            geo = e.geometry\n",
    "            weight = geo.volume * p.weight\n",
    "            R   += geo.toGlobal(p.position).two_norm * weight\n",
    "            vol += weight\n",
    "    return R/vol\n",
    "\n",
    "code = \"\"\"\n",
    "#include <dune/geometry/quadraturerules.hh>\n",
    "template< class Surface >\n",
    "double calcRadius( const Surface &surface ) {\n",
    "  double R = 0, vol = 0.;\n",
    "  for( const auto &entity : elements( surface ) ) {\n",
    "    const auto& rule = Dune::QuadratureRules<double, 2>::rule(entity.type(), 4);\n",
    "    for ( const auto &p : rule ) {\n",
    "      const auto geo = entity.geometry();\n",
    "      const double weight = geo.volume() * p.weight();\n",
    "      R   += geo.global(p.position()).two_norm() * weight;\n",
    "      vol += weight;\n",
    "    }\n",
    "  }\n",
    "  return R/vol;\n",
    "}\n",
    "\"\"\"\n",
    "switchCalcRadius = lambda use_cpp,surface: \\\n",
    "             algorithm.load('calcRadius', io.StringIO(code), surface) \\\n",
    "             if use_cpp else calcRadius"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3f1fb2e4",
   "metadata": {
    "lines_to_next_cell": 0
   },
   "source": [
    "Timings for a number of different grid refinements is dumped to disk"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "5f49214a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-02T14:01:03.100701Z",
     "iopub.status.busy": "2025-12-02T14:01:03.099890Z",
     "iopub.status.idle": "2025-12-02T14:01:03.113547Z",
     "shell.execute_reply": "2025-12-02T14:01:03.112387Z"
    }
   },
   "outputs": [],
   "source": [
    "from dune.fem.view import geometryGridView as geoGridView\n",
    "from dune.fem.space import lagrange as solutionSpace\n",
    "from dune.fem.scheme import galerkin as solutionScheme\n",
    "def calculate(use_cpp, gridView):\n",
    "    # space on Gamma_0 to describe position of Gamma(t)\n",
    "    space = solutionSpace(gridView, dimRange=gridView.dimWorld, order=order)\n",
    "    u = TrialFunction(space)\n",
    "    v = TestFunction(space)\n",
    "    x = SpatialCoordinate(space)\n",
    "    positions = space.interpolate(x, name=\"position\")\n",
    "\n",
    "    # space for discrete solution on Gamma(t)\n",
    "    surface = geoGridView(positions)\n",
    "    space = solutionSpace(surface, dimRange=surface.dimWorld, order=order)\n",
    "    solution  = space.interpolate(x, name=\"solution\")\n",
    "\n",
    "    # set up model using theta scheme\n",
    "    theta = 0.5   # Crank-Nicolson\n",
    "\n",
    "    I = Identity(3)\n",
    "    dt = dune.ufl.Constant(0,\"dt\")\n",
    "\n",
    "    a = (inner(u - x, v) + dt * inner(theta*grad(u)\n",
    "        + (1 - theta)*I, grad(v))) * dx\n",
    "\n",
    "    scheme = solutionScheme(a == 0, space, solver=\"cg\")\n",
    "\n",
    "    Rexact = lambda t: numpy.sqrt(R0*R0 - 4.*t)\n",
    "    radius = switchCalcRadius(use_cpp,surface)\n",
    "\n",
    "    dt.value = 0.02\n",
    "\n",
    "    numberOfLoops = 3\n",
    "    times = numpy.zeros(numberOfLoops)\n",
    "    errors = numpy.zeros(numberOfLoops)\n",
    "    totalIterations = numpy.zeros(numberOfLoops, numpy.dtype(numpy.uint32))\n",
    "    gridSizes = numpy.zeros(numberOfLoops, numpy.dtype(numpy.uint32))\n",
    "    for i in range(numberOfLoops):\n",
    "        positions.interpolate(x * (R0/sqrt(dot(x,x))))\n",
    "        solution.interpolate(x)\n",
    "        t = 0.\n",
    "        error = abs(radius(surface)-Rexact(t))\n",
    "        iterations = 0\n",
    "        start = time.time()\n",
    "        while t < endTime:\n",
    "            info = scheme.solve(target=solution)\n",
    "            # move the surface\n",
    "            positions.assign(solution)\n",
    "            # store some information about the solution process\n",
    "            iterations += int( info[\"linear_iterations\"] )\n",
    "            t          += scheme.model.dt\n",
    "            error       = max(error, abs(radius(surface)-Rexact(t)))\n",
    "        print(\"time used:\", time.time() - start)\n",
    "        times[i] = time.time() - start\n",
    "        errors[i] = error\n",
    "        totalIterations[i] = iterations\n",
    "        gridSizes[i] = gridView.size(2)\n",
    "        if i < numberOfLoops - 1:\n",
    "            gridView.hierarchicalGrid.globalRefine(1)\n",
    "            dt.value /= 2\n",
    "    eocs = numpy.log(errors[0:][:numberOfLoops-1] / errors[1:]) / numpy.log(numpy.sqrt(2))\n",
    "    try:\n",
    "        import pandas as pd\n",
    "        keys = {'size': gridSizes, 'error': errors, \"eoc\": numpy.insert(eocs, 0, None), 'iterations': totalIterations}\n",
    "        table = pd.DataFrame(keys, index=range(numberOfLoops),columns=['size', 'error', 'eoc', 'iterations'])\n",
    "        print(table)\n",
    "    except ImportError:\n",
    "        print(\"pandas module not found so not showing table - ignored\")\n",
    "        pass\n",
    "    return gridSizes, times"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c96a8f01",
   "metadata": {},
   "source": [
    "Compute the mean curvature flow evolution of a spherical surface. Compare\n",
    "computational time of a pure Python implementation and using a C++\n",
    "algorithm to compute the radius of the [surface](sphere.dgf) for verifying the\n",
    "algorithm."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "42917ae0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-02T14:01:03.116311Z",
     "iopub.status.busy": "2025-12-02T14:01:03.115468Z",
     "iopub.status.idle": "2025-12-02T14:01:20.077616Z",
     "shell.execute_reply": "2025-12-02T14:01:20.076501Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "time used: 0.19267630577087402\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "time used: 0.9850144386291504\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "time used: 4.015480995178223\n",
      "   size     error       eoc  iterations\n",
      "0   318  0.001060       NaN          76\n",
      "1   766  0.000605  1.619153         208\n",
      "2  1745  0.000275  2.275142         420\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "time used: 0.29302501678466797\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "time used: 1.5461111068725586\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "time used: 6.346624374389648\n",
      "   size     error       eoc  iterations\n",
      "0   318  0.001060       NaN          76\n",
      "1   766  0.000605  1.619153         208\n",
      "2  1745  0.000275  2.275142         420\n"
     ]
    }
   ],
   "source": [
    "# set up reference domain Gamma_0\n",
    "results = []\n",
    "from dune.alugrid import aluConformGrid as leafGridView\n",
    "gridView = leafGridView(\"sphere.dgf\", dimgrid=2, dimworld=3)\n",
    "results += [calculate(True, gridView)]\n",
    "\n",
    "gridView = leafGridView(\"sphere.dgf\", dimgrid=2, dimworld=3)\n",
    "results += [calculate(False, gridView)]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e0fe3ca0",
   "metadata": {},
   "source": [
    "Compare the hybrid and pure Python versions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "9bb445d6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-02T14:01:20.079412Z",
     "iopub.status.busy": "2025-12-02T14:01:20.079120Z",
     "iopub.status.idle": "2025-12-02T14:01:20.310100Z",
     "shell.execute_reply": "2025-12-02T14:01:20.309032Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/jpeg": "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",
      "text/plain": [
       "<Figure size 320x240 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plot(results[0],results[1])"
   ]
  }
 ],
 "metadata": {
  "jupytext": {
   "cell_metadata_filter": "-all"
  },
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.14.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}

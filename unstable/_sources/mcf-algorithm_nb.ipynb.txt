{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "35bc4823",
   "metadata": {},
   "source": [
    "# Mean Curvature Flow (revisited)\n",
    "\n",
    "[As discussed before](mcf_nb.ipynb)\n",
    "we can simulate the shrinking of a sphere under mean curvature flow\n",
    "using a finite element approach based on\n",
    "the following time discrete approximation:\n",
    "\\begin{align}\n",
    "\\int_{\\Gamma^n} \\big( U^{n+1} - {\\rm id}\\big) \\cdot \\varphi +\n",
    "\\tau \\int_{\\Gamma^n} \\big(\n",
    "\\theta\\nabla_{\\Gamma^n} U^{n+1} + (1-\\theta) I \\big)\n",
    "\\colon\\nabla_{\\Gamma^n}\\varphi\n",
    "=0~.\n",
    "\\end{align}\n",
    "Here $U^n$ parametrizes $\\Gamma(t^{n+1})$ over\n",
    "$\\Gamma^n:=\\Gamma(t^{n})$,\n",
    "$I$ is the identity matrix, $\\tau$ is the time step and\n",
    "$\\theta\\in[0,1]$ is a discretization parameter.\n",
    "\n",
    "If the initial surface $\\Gamma^0$ is a sphere of radius $R_0$,\n",
    "the surface remains sphere and we have an exact formula for the evolution\n",
    "of the radius of the surface\n",
    "\n",
    "$$R(t) = \\sqrt{R_0^2 - 4t}.$$\n",
    "\n",
    "To compare the accuracy of the surface approximation we compute an\n",
    "average radius of the discrete surface in each time step $t^n$ using\n",
    "\n",
    "$$R_h^n = \\frac{ \\int_{\\Gamma^n} |x| }{ |\\Gamma^n| }.$$\n",
    "\n",
    "Computing $R_h^n$ requires a grid traversal and a number of calls to\n",
    "interface methods on each element. Doing this on the Python side has a\n",
    "potential performance impact which we investigate here by comparing a\n",
    "pure python implementation with a hybrid approach where computing $R_h^n$\n",
    "is implemented in C++ using the `dune.generator.algorithm` functionality."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "1cbcfb51",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-11-30T14:14:08.016845Z",
     "iopub.status.busy": "2025-11-30T14:14:08.016665Z",
     "iopub.status.idle": "2025-11-30T14:14:09.064479Z",
     "shell.execute_reply": "2025-11-30T14:14:09.063447Z"
    }
   },
   "outputs": [],
   "source": [
    "import time, io\n",
    "import numpy\n",
    "from matplotlib import pyplot as plt\n",
    "from matplotlib.ticker import ScalarFormatter\n",
    "\n",
    "from ufl import *\n",
    "import dune.ufl\n",
    "from dune.generator import algorithm\n",
    "import dune.geometry as geometry\n",
    "import dune.fem as fem\n",
    "\n",
    "def plot(ct, ct2):\n",
    "    fig, ax = plt.subplots()\n",
    "    plt.loglog(ct[0][:], ct[1][:],'*-', markersize=15, label='hybrid')\n",
    "    plt.loglog(ct2[0][:], ct2[1][:],'*-', markersize=15, label='python')\n",
    "    plt.grid(True)\n",
    "    for axis in [ax.xaxis, ax.yaxis]:\n",
    "        axis.set_major_formatter(ScalarFormatter())\n",
    "        axis.set_minor_formatter(ScalarFormatter())\n",
    "    yticks = ax.yaxis.get_minor_ticks()\n",
    "    for t in yticks:\n",
    "        t.label1.set_visible(False)\n",
    "    xticks = ax.xaxis.get_minor_ticks()\n",
    "    for t in xticks:\n",
    "        t.label1.set_visible(False)\n",
    "    plt.yticks(numpy.append(ct[1], ct2[1]))\n",
    "    plt.xticks(ct[0])\n",
    "    plt.legend(loc=\"upper left\")\n",
    "    plt.xlabel('Number of Grid Elements (log)',fontsize=20)\n",
    "    plt.gcf().subplots_adjust(bottom=0.17, left=0.16)\n",
    "    plt.ylabel('Runtime in s (log)',fontsize=20)\n",
    "\n",
    "# polynomial order of surface approximation\n",
    "order = 2\n",
    "\n",
    "# initial radius\n",
    "R0 = 2.\n",
    "\n",
    "# end time\n",
    "endTime = 0.1"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "29596a95",
   "metadata": {
    "lines_to_next_cell": 0
   },
   "source": [
    "Main function for calculating the mean curvature flow of a given surface.\n",
    "If first argument is `True` the radius of the computed surface is\n",
    "computed using an algorithm implemented in C++ otherwise the computation\n",
    "is done in Python."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "45f6e9b1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-11-30T14:14:09.067210Z",
     "iopub.status.busy": "2025-11-30T14:14:09.066854Z",
     "iopub.status.idle": "2025-11-30T14:14:09.072917Z",
     "shell.execute_reply": "2025-11-30T14:14:09.072349Z"
    }
   },
   "outputs": [],
   "source": [
    "def calcRadius(surface):\n",
    "    R,vol = 0, 0\n",
    "    for e in surface.elements:\n",
    "        rule = geometry.quadratureRule(e.type, 4)\n",
    "        for p in rule:\n",
    "            geo = e.geometry\n",
    "            weight = geo.volume * p.weight\n",
    "            R   += geo.toGlobal(p.position).two_norm * weight\n",
    "            vol += weight\n",
    "    return R/vol\n",
    "\n",
    "code = \"\"\"\n",
    "#include <dune/geometry/quadraturerules.hh>\n",
    "template< class Surface >\n",
    "double calcRadius( const Surface &surface ) {\n",
    "  double R = 0, vol = 0.;\n",
    "  for( const auto &entity : elements( surface ) ) {\n",
    "    const auto& rule = Dune::QuadratureRules<double, 2>::rule(entity.type(), 4);\n",
    "    for ( const auto &p : rule ) {\n",
    "      const auto geo = entity.geometry();\n",
    "      const double weight = geo.volume() * p.weight();\n",
    "      R   += geo.global(p.position()).two_norm() * weight;\n",
    "      vol += weight;\n",
    "    }\n",
    "  }\n",
    "  return R/vol;\n",
    "}\n",
    "\"\"\"\n",
    "switchCalcRadius = lambda use_cpp,surface: \\\n",
    "             algorithm.load('calcRadius', io.StringIO(code), surface) \\\n",
    "             if use_cpp else calcRadius"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b07f40dc",
   "metadata": {
    "lines_to_next_cell": 0
   },
   "source": [
    "Timings for a number of different grid refinements is dumped to disk"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "a3bb266c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-11-30T14:14:09.076272Z",
     "iopub.status.busy": "2025-11-30T14:14:09.075413Z",
     "iopub.status.idle": "2025-11-30T14:14:09.088651Z",
     "shell.execute_reply": "2025-11-30T14:14:09.088066Z"
    }
   },
   "outputs": [],
   "source": [
    "from dune.fem.view import geometryGridView as geoGridView\n",
    "from dune.fem.space import lagrange as solutionSpace\n",
    "from dune.fem.scheme import galerkin as solutionScheme\n",
    "def calculate(use_cpp, gridView):\n",
    "    # space on Gamma_0 to describe position of Gamma(t)\n",
    "    space = solutionSpace(gridView, dimRange=gridView.dimWorld, order=order)\n",
    "    u = TrialFunction(space)\n",
    "    v = TestFunction(space)\n",
    "    x = SpatialCoordinate(space)\n",
    "    positions = space.interpolate(x, name=\"position\")\n",
    "\n",
    "    # space for discrete solution on Gamma(t)\n",
    "    surface = geoGridView(positions)\n",
    "    space = solutionSpace(surface, dimRange=surface.dimWorld, order=order)\n",
    "    solution  = space.interpolate(x, name=\"solution\")\n",
    "\n",
    "    # set up model using theta scheme\n",
    "    theta = 0.5   # Crank-Nicolson\n",
    "\n",
    "    I = Identity(3)\n",
    "    dt = dune.ufl.Constant(0,\"dt\")\n",
    "\n",
    "    a = (inner(u - x, v) + dt * inner(theta*grad(u)\n",
    "        + (1 - theta)*I, grad(v))) * dx\n",
    "\n",
    "    scheme = solutionScheme(a == 0, space, solver=\"cg\")\n",
    "\n",
    "    Rexact = lambda t: numpy.sqrt(R0*R0 - 4.*t)\n",
    "    radius = switchCalcRadius(use_cpp,surface)\n",
    "\n",
    "    dt.value = 0.02\n",
    "\n",
    "    numberOfLoops = 3\n",
    "    times = numpy.zeros(numberOfLoops)\n",
    "    errors = numpy.zeros(numberOfLoops)\n",
    "    totalIterations = numpy.zeros(numberOfLoops, numpy.dtype(numpy.uint32))\n",
    "    gridSizes = numpy.zeros(numberOfLoops, numpy.dtype(numpy.uint32))\n",
    "    for i in range(numberOfLoops):\n",
    "        positions.interpolate(x * (R0/sqrt(dot(x,x))))\n",
    "        solution.interpolate(x)\n",
    "        t = 0.\n",
    "        error = abs(radius(surface)-Rexact(t))\n",
    "        iterations = 0\n",
    "        start = time.time()\n",
    "        while t < endTime:\n",
    "            info = scheme.solve(target=solution)\n",
    "            # move the surface\n",
    "            positions.assign(solution)\n",
    "            # store some information about the solution process\n",
    "            iterations += int( info[\"linear_iterations\"] )\n",
    "            t          += scheme.model.dt\n",
    "            error       = max(error, abs(radius(surface)-Rexact(t)))\n",
    "        print(\"time used:\", time.time() - start)\n",
    "        times[i] = time.time() - start\n",
    "        errors[i] = error\n",
    "        totalIterations[i] = iterations\n",
    "        gridSizes[i] = gridView.size(2)\n",
    "        if i < numberOfLoops - 1:\n",
    "            gridView.hierarchicalGrid.globalRefine(1)\n",
    "            dt.value /= 2\n",
    "    eocs = numpy.log(errors[0:][:numberOfLoops-1] / errors[1:]) / numpy.log(numpy.sqrt(2))\n",
    "    try:\n",
    "        import pandas as pd\n",
    "        keys = {'size': gridSizes, 'error': errors, \"eoc\": numpy.insert(eocs, 0, None), 'iterations': totalIterations}\n",
    "        table = pd.DataFrame(keys, index=range(numberOfLoops),columns=['size', 'error', 'eoc', 'iterations'])\n",
    "        print(table)\n",
    "    except ImportError:\n",
    "        print(\"pandas module not found so not showing table - ignored\")\n",
    "        pass\n",
    "    return gridSizes, times"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cda288cb",
   "metadata": {},
   "source": [
    "Compute the mean curvature flow evolution of a spherical surface. Compare\n",
    "computational time of a pure Python implementation and using a C++\n",
    "algorithm to compute the radius of the [surface](sphere.dgf) for verifying the\n",
    "algorithm."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "c5174ef0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-11-30T14:14:09.091095Z",
     "iopub.status.busy": "2025-11-30T14:14:09.090865Z",
     "iopub.status.idle": "2025-11-30T14:14:26.213771Z",
     "shell.execute_reply": "2025-11-30T14:14:26.212670Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "time used: 0.19104504585266113\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "time used: 0.9796419143676758\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "time used: 4.024980783462524\n",
      "   size     error       eoc  iterations\n",
      "0   318  0.001060       NaN          76\n",
      "1   766  0.000605  1.619153         208\n",
      "2  1745  0.000275  2.275142         420\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "time used: 0.29445838928222656\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "time used: 1.566284418106079\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "time used: 6.387953042984009\n",
      "   size     error       eoc  iterations\n",
      "0   318  0.001060       NaN          76\n",
      "1   766  0.000605  1.619153         208\n",
      "2  1745  0.000275  2.275142         420\n"
     ]
    }
   ],
   "source": [
    "# set up reference domain Gamma_0\n",
    "results = []\n",
    "from dune.alugrid import aluConformGrid as leafGridView\n",
    "gridView = leafGridView(\"sphere.dgf\", dimgrid=2, dimworld=3)\n",
    "results += [calculate(True, gridView)]\n",
    "\n",
    "gridView = leafGridView(\"sphere.dgf\", dimgrid=2, dimworld=3)\n",
    "results += [calculate(False, gridView)]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "96811df7",
   "metadata": {},
   "source": [
    "Compare the hybrid and pure Python versions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "b0e76273",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-11-30T14:14:26.215594Z",
     "iopub.status.busy": "2025-11-30T14:14:26.215302Z",
     "iopub.status.idle": "2025-11-30T14:14:26.447282Z",
     "shell.execute_reply": "2025-11-30T14:14:26.446156Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/jpeg": "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",
      "text/plain": [
       "<Figure size 320x240 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plot(results[0],results[1])"
   ]
  }
 ],
 "metadata": {
  "jupytext": {
   "cell_metadata_filter": "-all"
  },
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.14.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}

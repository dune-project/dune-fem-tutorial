{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "037b6665",
   "metadata": {
    "lines_to_next_cell": 0
   },
   "source": [
    ".. index::\n",
    "   triple: I/O; Sampling (line/point); Plotting\n",
    "\n",
    "# Sampling the Solution over a Line\n",
    "Let us revisit our simple 3d example from the introduction"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "4d7c0788",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-01T21:49:04.051460Z",
     "iopub.status.busy": "2025-12-01T21:49:04.051191Z",
     "iopub.status.idle": "2025-12-01T21:49:05.491527Z",
     "shell.execute_reply": "2025-12-01T21:49:05.490405Z"
    }
   },
   "outputs": [],
   "source": [
    "from matplotlib import pyplot\n",
    "import numpy\n",
    "try:\n",
    "    import pygmsh\n",
    "    with pygmsh.geo.Geometry() as geom:\n",
    "        poly = geom.add_polygon([\n",
    "              [ 0.0,  0.5, 0.0], [-0.1,  0.1, 0.0], [-0.5,  0.0, 0.0],\n",
    "              [-0.1, -0.1, 0.0], [ 0.0, -0.5, 0.0], [ 0.1, -0.1, 0.0],\n",
    "              [ 0.5,  0.0, 0.0], [ 0.1,  0.1, 0.0] ], mesh_size=0.05)\n",
    "        geom.twist(\n",
    "            poly,\n",
    "            translation_axis=[0, 0, 1], rotation_axis=[0, 0, 1], point_on_axis=[0, 0, 0],\n",
    "            angle=numpy.pi / 3,\n",
    "        )\n",
    "        mesh = geom.generate_mesh(verbose=False)\n",
    "\n",
    "    points, cells = mesh.points, mesh.cells_dict\n",
    "    domain3d = {\"vertices\":points.astype(\"float\"), \"simplices\":cells[\"tetra\"]}\n",
    "except ImportError: # pygmsh not installed - use a simple cartesian domain\n",
    "    print(\"pygmsh module not found using a simple Cartesian domain - ignored\")\n",
    "    from dune.grid import cartesianDomain\n",
    "    domain3d = cartesianDomain([-0.25,-0.25,0],[0.25,0.25,1],[30,30,60])\n",
    "\n",
    "from dune.alugrid import aluSimplexGrid as leafGridView3d\n",
    "gridView3d  = leafGridView3d(domain3d)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c45c9694",
   "metadata": {
    "lines_to_next_cell": 0
   },
   "source": [
    "As before we solve a simple Laplace problem"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "b919652b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-01T21:49:05.494232Z",
     "iopub.status.busy": "2025-12-01T21:49:05.493880Z",
     "iopub.status.idle": "2025-12-01T21:49:06.372571Z",
     "shell.execute_reply": "2025-12-01T21:49:06.370957Z"
    }
   },
   "outputs": [],
   "source": [
    "from dune.fem.space import lagrange as solutionSpace\n",
    "from dune.fem.scheme import galerkin as solutionScheme\n",
    "from ufl import TrialFunction, TestFunction, SpatialCoordinate, dot, grad, dx, conditional, sqrt\n",
    "\n",
    "space3d = solutionSpace(gridView3d, order=1)\n",
    "u = TrialFunction(space3d)\n",
    "v = TestFunction(space3d)\n",
    "x = SpatialCoordinate(space3d)\n",
    "scheme3d = solutionScheme((dot(grad(u),grad(v))+u*v)*dx ==\n",
    "                        conditional(dot(x,x)<.01,100,0)*v*dx,\n",
    "                        solver='cg')\n",
    "uh3d = space3d.interpolate(0,name=\"solution\")\n",
    "info = scheme3d.solve(target=uh3d)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "26d10c3a",
   "metadata": {
    "lines_to_next_cell": 0
   },
   "source": [
    "Instead of plotting this using paraview we want to only study the\n",
    "solution along a single line. This requires findings points\n",
    "$x_i = x_0+\\frac{i}{N}(x1-x0)$ for $i=0,\\dots,N$ within the unstructured\n",
    "grid. This would be expensive to compute on the Python so we implement\n",
    "this algorithm in C++ using the `LineSegmentSampler` class available in\n",
    "`Dune-Fem`. The resulting `algorithm` returns a pair of two lists with\n",
    "coordinates $x_i$ and the values of the grid function at these points:\n",
    "\n",
    ".. literalinclude:: utility.hh\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "b6e679b4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-01T21:49:06.375147Z",
     "iopub.status.busy": "2025-12-01T21:49:06.374560Z",
     "iopub.status.idle": "2025-12-01T21:49:06.512680Z",
     "shell.execute_reply": "2025-12-01T21:49:06.511764Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f8f9d623620>]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/jpeg": "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",
      "text/plain": [
       "<Figure size 320x240 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import dune.generator.algorithm as algorithm\n",
    "from dune.common import FieldVector\n",
    "x0, x1 = FieldVector([0,0,0]), FieldVector([0,0,1])\n",
    "p,v = algorithm.run('sample', 'utility.hh', uh3d, x0, x1, 100)\n",
    "x,y = numpy.zeros(len(p)), numpy.zeros(len(p))\n",
    "length = (x1-x0).two_norm\n",
    "for i in range(len(x)):\n",
    "    x[i] = (p[i]-x0).two_norm / length\n",
    "    y[i] = v[i][0]\n",
    "pyplot.plot(x,y)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "47caa5e3",
   "metadata": {
    "lines_to_next_cell": 0
   },
   "source": [
    "**Note**: the coordinates returned are always in the interval $[0,1]$ so\n",
    "if physical coordinates are required, they need to be rescaled.\n",
    "Also, function values returned by the `sample` function\n",
    "are always of a `FieldVector` type, so that even for a scalar example\n",
    "a `v[i]` is a vector of dimension one, so that `y[i]=v[i][0]` has to be\n",
    "used.\n",
    "\n",
    "A mentioned above any grid function can be passed in as argument to the\n",
    "`sample` function. So for example plotting $|\\nabla u_h|$ is straight\n",
    "forward using the corresponding ufl expression. Since in this case\n",
    "automatic conversion from the ufl expression (available for example in the\n",
    "plotting function) to a grid function, we need to do this explicitly:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "5ef27f0a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-01T21:49:06.514438Z",
     "iopub.status.busy": "2025-12-01T21:49:06.514247Z",
     "iopub.status.idle": "2025-12-01T21:49:06.710866Z",
     "shell.execute_reply": "2025-12-01T21:49:06.710047Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f8f992496a0>]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/jpeg": "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",
      "text/plain": [
       "<Figure size 320x240 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "from dune.fem.function import gridFunction\n",
    "absGrad = gridFunction(sqrt(dot(grad(uh3d),grad(uh3d))))\n",
    "p,v = algorithm.run('sample', 'utility.hh', absGrad, x0, x1, 100)\n",
    "for i in range(len(x)):\n",
    "    y[i] = v[i][0]\n",
    "pyplot.plot(x,y)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "795b5192",
   "metadata": {
    "lines_to_next_cell": 0
   },
   "source": [
    "Similar we can plot both partial derivatives of the solution over the\n",
    "given line:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "39954093",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-01T21:49:06.712756Z",
     "iopub.status.busy": "2025-12-01T21:49:06.712541Z",
     "iopub.status.idle": "2025-12-01T21:49:06.914101Z",
     "shell.execute_reply": "2025-12-01T21:49:06.913152Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f8f9906e3c0>]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/jpeg": "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",
      "text/plain": [
       "<Figure size 320x240 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "absGrad = gridFunction(grad(uh3d))\n",
    "p,v = algorithm.run('sample', 'utility.hh', absGrad, x0, x1, 100)\n",
    "dx,dy = numpy.zeros(len(p)), numpy.zeros(len(p))\n",
    "for i in range(len(x)):\n",
    "    dx[i] = v[i][0]\n",
    "    dy[i] = v[i][1]\n",
    "pyplot.plot(x,dx)\n",
    "pyplot.plot(x,dy)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6b966530",
   "metadata": {
    "lines_to_next_cell": 0
   },
   "source": [
    "**Remark:** plotting over a line has been included as a utility function\n",
    "so can easily be called as shown below"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "629cbf40",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-01T21:49:06.916278Z",
     "iopub.status.busy": "2025-12-01T21:49:06.916062Z",
     "iopub.status.idle": "2025-12-01T21:49:07.038644Z",
     "shell.execute_reply": "2025-12-01T21:49:07.037667Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f8f987970e0>]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/jpeg": "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",
      "text/plain": [
       "<Figure size 320x240 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "from dune.fem.utility import lineSample\n",
    "x,y = lineSample(uh3d,[0,0,0],[0,0,1],100)\n",
    "pyplot.plot(x,y)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "13ba20f9",
   "metadata": {},
   "source": [
    "The functions takes the two endpoints of the line and the number of\n",
    "(equidistant) sample points as arguments. By default the method throws an\n",
    "exception if part of the line is outside of the computational domain.\n",
    "This behavior can be disabled by setting the additional optional\n",
    ":code:`bool` parameter :code:`allowOutside` to :code:`True`.\n",
    "\n",
    "Similar functions are available to obtain a :code:`pointSample` and to\n",
    "sample a grid function along the boundary (:code:`boundarySample`)."
   ]
  }
 ],
 "metadata": {
  "jupytext": {
   "cell_metadata_filter": "-all"
  },
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.14.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}

[jupytext] Reading laplace-dwr-algorithm.py in format py
[jupytext] Setting kernel python3
[jupytext] Updating notebook metadata with '{"kernelspec": {"name": "python3", "language": "python", "display_name": "Python 3 (ipykernel)"}}'
[jupytext] Executing notebook with kernel python3
Traceback (most recent call last):
  File "/home/dedner/dune-core/lib/python3.12/site-packages/jupyter_core/utils/__init__.py", line 154, in wrapped
    asyncio.get_running_loop()
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/dedner/dune-core/bin/jupytext", line 8, in <module>
    sys.exit(jupytext())
             ^^^^^^^^^^
  File "/home/dedner/dune-core/lib/python3.12/site-packages/jupytext/cli.py", line 497, in jupytext
    exit_code += jupytext_single_file(nb_file, args, log)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dedner/dune-core/lib/python3.12/site-packages/jupytext/cli.py", line 741, in jupytext_single_file
    exec_proc.preprocess(notebook, resources=resources)
  File "/home/dedner/dune-core/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py", line 103, in preprocess
    self.preprocess_cell(cell, resources, index)
  File "/home/dedner/dune-core/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py", line 124, in preprocess_cell
    cell = self.execute_cell(cell, index, store_history=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dedner/dune-core/lib/python3.12/site-packages/jupyter_core/utils/__init__.py", line 158, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/dedner/dune-core/lib/python3.12/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/dedner/dune-core/lib/python3.12/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
compute( getFunctional(cpp=False), tolerance=1e-4 )
------------------


[31m---------------------------------------------------------------------------[39m
[31mTypeError[39m                                 Traceback (most recent call last)
[36mCell[39m[36m [39m[32mIn[6][39m[32m, line 1[39m
[32m----> [39m[32m1[39m [43mcompute[49m[43m([49m[43m [49m[43mgetFunctional[49m[43m([49m[43mcpp[49m[43m=[49m[38;5;28;43;01mFalse[39;49;00m[43m)[49m[43m,[49m[43m [49m[43mtolerance[49m[43m=[49m[32;43m1e-4[39;49m[43m [49m[43m)[49m

[36mCell[39m[36m [39m[32mIn[5][39m[32m, line 32[39m, in [36mcompute[39m[34m(computeFunctional, tolerance)[39m
[32m     30[39m     [38;5;66;03m# update refinement tolerance[39;00m
[32m     31[39m     hTol = eta/uh.space.gridView.size([32m0[39m)
[32m---> [39m[32m32[39m     [43mfem[49m[43m.[49m[43mgridAdapt[49m[43m([49m[43mmarker[49m[43m,[49m[43m [49m[43muh[49m[43m)[49m [38;5;66;03m# can also be a list or tuple of function to prolong/restrict[39;00m
[32m     33[39m     count += [32m1[39m
[32m     34[39m plot(uh, figure=(fig, [32m122[39m), colorbar=[38;5;28;01mFalse[39;00m, linewidth=[32m1[39m)

[36mFile [39m[32m~/DUNE_PYTHON/dune-fem/build-cmake/python/dune/fem/_adaptation.py:201[39m, in [36mgridAdapt[39m[34m(marker, *args)[39m
[32m    198[39m [38;5;28;01mif[39;00m marker [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[32m    199[39m     [38;5;28;01mif[39;00m [38;5;28misinstance[39m(marker, GridMarker):
[32m    200[39m         [38;5;66;03m# GridMarker object using gridView.mark[39;00m
[32m--> [39m[32m201[39m         [43mmarker[49m[43m([49m[43m)[49m
[32m    202[39m     [38;5;28;01melse[39;00m:
[32m    203[39m         [38;5;66;03m# Python or C++ callable[39;00m
[32m    204[39m         hgrid.mark( marker )

[36mFile [39m[32m~/DUNE_PYTHON/dune-fem/build-cmake/python/dune/fem/_adaptation.py:131[39m, in [36mGridMarker.__call__[39m[34m(self)[39m
[32m    128[39m [38;5;28;01mexcept[39;00m [38;5;167;01mAttributeError[39;00m:
[32m    129[39m     [38;5;28;01mraise[39;00m [38;5;167;01mAttributeError[39;00m([33m"[39m[33mindicator function must be over grid view that supports adaptation[39m[33m"[39m)
[32m--> [39m[32m131[39m [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[43m.[49m[43mgridView[49m[43m.[49m[43mmark[49m[43m([49m[43mindicatorGF[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m.[49m[43mrefineTolerance[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m.[49m[43mcoarsenTolerance[49m[43m,[49m
[32m    132[39m [43m                          [49m[38;5;28;43mself[39;49m[43m.[49m[43mminLevel[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m.[49m[43mmaxLevel[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m.[49m[43mminVolume[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m.[49m[43mmaxVolume[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m.[49m[43mmarkNeighbors[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m.[49m[43mstatistics[49m[43m)[49m

[31mTypeError[39m: mark(): incompatible function arguments. The following argument types are supported:
    1. (self: dune.generated.view_af122c1df944c95cd395ec0f91d0f970.GridView, arg0: Dune::FemPy::VirtualizedGridFunction<Dune::Fem::AdaptiveLeafGridPart<Dune::ALUGrid<2, 2, (Dune::ALUGridElementType)0, (Dune::ALUGridRefinementType)1, Dune::ALUGridMPIComm>, (Dune::PartitionIteratorType)4, false>, Dune::FieldVector<double, 1> >, arg1: float, arg2: float, arg3: int, arg4: int, arg5: float, arg6: float, arg7: bool, arg8: bool) -> tuple[int, int]

Invoked with: LeafGrid with 32 elements, <dune.generated.femspace_fd922cf30481b58e807549a9a6a8b5de_2cb45735d04db759525333f5f2d41cac.DiscreteFunction object at 0x717eef3e0530>, <function compute.<locals>.<lambda> at 0x717edc756b60>, 0.0, 0, -1, -1.0, -1.0, False, False

[jupytext] Reading laplace-dwr.py in format py
[jupytext] Setting kernel python3
[jupytext] Updating notebook metadata with '{"kernelspec": {"name": "python3", "language": "python", "display_name": "Python 3 (ipykernel)"}}'
[jupytext] Executing notebook with kernel python3
Traceback (most recent call last):
  File "/home/dedner/dune-core/lib/python3.12/site-packages/jupyter_core/utils/__init__.py", line 154, in wrapped
    asyncio.get_running_loop()
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/dedner/dune-core/bin/jupytext", line 8, in <module>
    sys.exit(jupytext())
             ^^^^^^^^^^
  File "/home/dedner/dune-core/lib/python3.12/site-packages/jupytext/cli.py", line 497, in jupytext
    exit_code += jupytext_single_file(nb_file, args, log)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dedner/dune-core/lib/python3.12/site-packages/jupytext/cli.py", line 741, in jupytext_single_file
    exec_proc.preprocess(notebook, resources=resources)
  File "/home/dedner/dune-core/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py", line 103, in preprocess
    self.preprocess_cell(cell, resources, index)
  File "/home/dedner/dune-core/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py", line 124, in preprocess_cell
    cell = self.execute_cell(cell, index, store_history=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dedner/dune-core/lib/python3.12/site-packages/jupyter_core/utils/__init__.py", line 158, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/dedner/dune-core/lib/python3.12/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/dedner/dune-core/lib/python3.12/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
fig = pyplot.figure(figsize=(20,10))
dofs, estimateVector, errorVector = compute( tolerance=1e-6, fig=fig )
------------------


[31m---------------------------------------------------------------------------[39m
[31mTypeError[39m                                 Traceback (most recent call last)
[36mCell[39m[36m [39m[32mIn[6][39m[32m, line 2[39m
[32m      1[39m fig = pyplot.figure(figsize=([32m20[39m,[32m10[39m))
[32m----> [39m[32m2[39m dofs, estimateVector, errorVector = [43mcompute[49m[43m([49m[43m [49m[43mtolerance[49m[43m=[49m[32;43m1e-6[39;49m[43m,[49m[43m [49m[43mfig[49m[43m=[49m[43mfig[49m[43m [49m[43m)[49m

[36mCell[39m[36m [39m[32mIn[5][39m[32m, line 29[39m, in [36mcompute[39m[34m(tolerance, fig)[39m
[32m     27[39m     [38;5;66;03m# update refinement tolerance[39;00m
[32m     28[39m     hTol = eta/uh.space.gridView.size([32m0[39m)
[32m---> [39m[32m29[39m     [43mfem[49m[43m.[49m[43mgridAdapt[49m[43m([49m[43mmarker[49m[43m,[49m[43m [49m[43muh[49m[43m)[49m [38;5;66;03m# can also be a list or tuple of function to prolong/restrict[39;00m
[32m     30[39m     count += [32m1[39m
[32m     31[39m plot(uh, figure=(fig, [32m122[39m), colorbar=[38;5;28;01mFalse[39;00m, linewidth=[32m1[39m)

[36mFile [39m[32m~/DUNE_PYTHON/dune-fem/build-cmake/python/dune/fem/_adaptation.py:201[39m, in [36mgridAdapt[39m[34m(marker, *args)[39m
[32m    198[39m [38;5;28;01mif[39;00m marker [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[32m    199[39m     [38;5;28;01mif[39;00m [38;5;28misinstance[39m(marker, GridMarker):
[32m    200[39m         [38;5;66;03m# GridMarker object using gridView.mark[39;00m
[32m--> [39m[32m201[39m         [43mmarker[49m[43m([49m[43m)[49m
[32m    202[39m     [38;5;28;01melse[39;00m:
[32m    203[39m         [38;5;66;03m# Python or C++ callable[39;00m
[32m    204[39m         hgrid.mark( marker )

[36mFile [39m[32m~/DUNE_PYTHON/dune-fem/build-cmake/python/dune/fem/_adaptation.py:131[39m, in [36mGridMarker.__call__[39m[34m(self)[39m
[32m    128[39m [38;5;28;01mexcept[39;00m [38;5;167;01mAttributeError[39;00m:
[32m    129[39m     [38;5;28;01mraise[39;00m [38;5;167;01mAttributeError[39;00m([33m"[39m[33mindicator function must be over grid view that supports adaptation[39m[33m"[39m)
[32m--> [39m[32m131[39m [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[43m.[49m[43mgridView[49m[43m.[49m[43mmark[49m[43m([49m[43mindicatorGF[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m.[49m[43mrefineTolerance[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m.[49m[43mcoarsenTolerance[49m[43m,[49m
[32m    132[39m [43m                          [49m[38;5;28;43mself[39;49m[43m.[49m[43mminLevel[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m.[49m[43mmaxLevel[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m.[49m[43mminVolume[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m.[49m[43mmaxVolume[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m.[49m[43mmarkNeighbors[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m.[49m[43mstatistics[49m[43m)[49m

[31mTypeError[39m: mark(): incompatible function arguments. The following argument types are supported:
    1. (self: dune.generated.view_af122c1df944c95cd395ec0f91d0f970.GridView, arg0: Dune::FemPy::VirtualizedGridFunction<Dune::Fem::AdaptiveLeafGridPart<Dune::ALUGrid<2, 2, (Dune::ALUGridElementType)0, (Dune::ALUGridRefinementType)1, Dune::ALUGridMPIComm>, (Dune::PartitionIteratorType)4, false>, Dune::FieldVector<double, 1> >, arg1: float, arg2: float, arg3: int, arg4: int, arg5: float, arg6: float, arg7: bool, arg8: bool) -> tuple[int, int]

Invoked with: LeafGrid with 32 elements, <dune.generated.femspace_fd922cf30481b58e807549a9a6a8b5de_2cb45735d04db759525333f5f2d41cac.DiscreteFunction object at 0x7ce7643a4470>, <function compute.<locals>.<lambda> at 0x7ce764072de0>, 0.0, 0, -1, -1.0, -1.0, False, False

make: [Makefile:78: laplace-dwr-algorithm_nb.ipynb] Error 1 (ignored)
make: [Makefile:78: laplace-dwr_nb.ipynb] Error 1 (ignored)
[jupytext] Reading solversInternal.py in format py
[jupytext] Setting kernel python3
[jupytext] Updating notebook metadata with '{"kernelspec": {"name": "python3", "language": "python", "display_name": "Python 3 (ipykernel)"}}'
[jupytext] Executing notebook with kernel python3
Traceback (most recent call last):
  File "/home/dedner/dune-core/lib/python3.12/site-packages/jupyter_core/utils/__init__.py", line 154, in wrapped
    asyncio.get_running_loop()
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/dedner/dune-core/bin/jupytext", line 8, in <module>
    sys.exit(jupytext())
             ^^^^^^^^^^
  File "/home/dedner/dune-core/lib/python3.12/site-packages/jupytext/cli.py", line 497, in jupytext
    exit_code += jupytext_single_file(nb_file, args, log)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dedner/dune-core/lib/python3.12/site-packages/jupytext/cli.py", line 741, in jupytext_single_file
    exec_proc.preprocess(notebook, resources=resources)
  File "/home/dedner/dune-core/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py", line 103, in preprocess
    self.preprocess_cell(cell, resources, index)
  File "/home/dedner/dune-core/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py", line 124, in preprocess_cell
    cell = self.execute_cell(cell, index, store_history=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dedner/dune-core/lib/python3.12/site-packages/jupyter_core/utils/__init__.py", line 158, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/dedner/dune-core/lib/python3.12/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/dedner/dune-core/lib/python3.12/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
if petsc:
    spacePetsc = lagrange(gridView, order=2, storage='petsc')
    # We use an sor preconditioner:
    schemePetsc = galerkin([a == bf+bg, DirichletBC(space,exact,2)],
                           space=spacePetsc, solver="cg",
                           parameters={"linear.preconditioning.method":"hypre"})
    uPetsc_h = spacePetsc.interpolate(2, name='u_h')
    info = schemePetsc.solve(target=uPetsc_h)
    printResult("PETSc",uPetsc_h-exact,info)
------------------


[31m---------------------------------------------------------------------------[39m
[31mRuntimeError[39m                              Traceback (most recent call last)
[36mCell[39m[36m [39m[32mIn[14][39m[32m, line 7[39m
[32m      3[39m [38;5;66;03m# We use an sor preconditioner:[39;00m
[32m      4[39m schemePetsc = galerkin([a == bf+bg, DirichletBC(space,exact,[32m2[39m)],
[32m      5[39m                        space=spacePetsc, solver=[33m"[39m[33mcg[39m[33m"[39m,
[32m      6[39m                        parameters={[33m"[39m[33mlinear.preconditioning.method[39m[33m"[39m:[33m"[39m[33mhypre[39m[33m"[39m})
[32m----> [39m[32m7[39m uPetsc_h = [43mspacePetsc[49m[43m.[49m[43minterpolate[49m[43m([49m[32;43m2[39;49m[43m,[49m[43m [49m[43mname[49m[43m=[49m[33;43m'[39;49m[33;43mu_h[39;49m[33;43m'[39;49m[43m)[49m
[32m      8[39m info = schemePetsc.solve(target=uPetsc_h)
[32m      9[39m printResult([33m"[39m[33mPETSc[39m[33m"[39m,uPetsc_h-exact,info)

[36mFile [39m[32m~/DUNE_PYTHON/dune-fem/build-cmake/python/dune/ufl/__init__.py:203[39m, in [36mFemSpace.__getattr__.<locals>.tocontainer.<locals>.wrapper[39m[34m(*args, **kwargs)[39m
[32m    201[39m [38;5;129m@wraps[39m(func)
[32m    202[39m [38;5;28;01mdef[39;00m[38;5;250m [39m[34mwrapper[39m(*args, **kwargs):
[32m--> [39m[32m203[39m     [38;5;28;01mreturn[39;00m [43mfunc[49m[43m([49m[43m*[49m[43margs[49m[43m,[49m[43m [49m[43m*[49m[43m*[49m[43mkwargs[49m[43m)[49m

[36mFile [39m[32m~/DUNE_PYTHON/dune-fem/build-cmake/python/dune/fem/space/__init__.py:189[39m, in [36mspcInterpolate[39m[34m(self, *args, **kwargs)[39m
[32m    188[39m [38;5;28;01mdef[39;00m[38;5;250m [39m[34mspcInterpolate[39m([38;5;28mself[39m,*args,**kwargs):
[32m--> [39m[32m189[39m     [38;5;28;01mreturn[39;00m [43minterpolate[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m*[49m[43margs[49m[43m,[49m[43m*[49m[43m*[49m[43mkwargs[49m[43m)[49m

[36mFile [39m[32m~/DUNE_PYTHON/dune-fem/build-cmake/python/dune/fem/space/__init__.py:46[39m, in [36minterpolate[39m[34m(space, expr, name, **kwargs)[39m
[32m     44[39m     [38;5;28;01mexcept[39;00m [38;5;167;01mAttributeError[39;00m:
[32m     45[39m         [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m([33m"[39m[33minterpolation requires a name for the resulting discrete function - either the expression needs a name attribute or [39m[33m'[39m[33mname[39m[33m'[39m[33m needs to be provided as second argument.[39m[33m"[39m)
[32m---> [39m[32m46[39m [38;5;28;01mreturn[39;00m [43mfunction[49m[43m.[49m[43mdiscreteFunction[49m[43m([49m[43mspace[49m[43m,[49m[43m [49m[43mname[49m[43m=[49m[43mname[49m[43m,[49m[43m [49m[43mexpr[49m[43m=[49m[43mexpr[49m[43m,[49m[43m [49m[43m*[49m[43m*[49m[43mkwargs[49m[43m)[49m

[36mFile [39m[32m~/DUNE_PYTHON/dune-fem/build-cmake/python/dune/fem/function/_functions.py:218[39m, in [36mdiscreteFunction[39m[34m(space, name, expr, dofVector)[39m
[32m    206[39m [38;5;250m[39m[33;03m"""create a discrete function[39;00m
[32m    207[39m 
[32m    208[39m [33;03mArgs:[39;00m
[32m   (...)[39m[32m    214[39m [33;03m    DiscreteFunction: the constructed discrete function[39;00m
[32m    215[39m [33;03m"""[39;00m
[32m    217[39m [38;5;28;01mif[39;00m dofVector [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[32m--> [39m[32m218[39m     df = [43mspace[49m[43m.[49m[43mDiscreteFunction[49m[43m([49m[43mspace[49m[43m,[49m[43mname[49m[43m)[49m
[32m    219[39m [38;5;28;01melse[39;00m:
[32m    220[39m     _assertSizesMatch(space, dofVector)

[31mRuntimeError[39m: Exception [ErrorCheck:/home/dedner/DUNE_PYTHON/dune-fem/dune/fem/misc/petsc/petsccommon.hh:88]: Generic PETSC exception

make: [Makefile:78: solversInternal_nb.ipynb] Error 1 (ignored)
[jupytext] Reading twophaseflow.py in format py
[jupytext] Setting kernel python3
[jupytext] Updating notebook metadata with '{"kernelspec": {"name": "python3", "language": "python", "display_name": "Python 3 (ipykernel)"}}'
[jupytext] Executing notebook with kernel python3
Traceback (most recent call last):
  File "/home/dedner/dune-core/lib/python3.12/site-packages/jupyter_core/utils/__init__.py", line 154, in wrapped
    asyncio.get_running_loop()
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/dedner/dune-core/bin/jupytext", line 8, in <module>
    sys.exit(jupytext())
             ^^^^^^^^^^
  File "/home/dedner/dune-core/lib/python3.12/site-packages/jupytext/cli.py", line 497, in jupytext
    exit_code += jupytext_single_file(nb_file, args, log)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dedner/dune-core/lib/python3.12/site-packages/jupytext/cli.py", line 741, in jupytext_single_file
    exec_proc.preprocess(notebook, resources=resources)
  File "/home/dedner/dune-core/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py", line 103, in preprocess
    self.preprocess_cell(cell, resources, index)
  File "/home/dedner/dune-core/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py", line 124, in preprocess_cell
    cell = self.execute_cell(cell, index, store_history=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dedner/dune-core/lib/python3.12/site-packages/jupyter_core/utils/__init__.py", line 158, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/dedner/dune-core/lib/python3.12/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/dedner/dune-core/lib/python3.12/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
hgrid = grid.hierarchicalGrid
hgrid.globalRefine(1)
for i in range(maxLevel):
    print("pre adaptive (",i,"): ",grid.size(0),end="\n")
    solution.interpolate( as_vector([p_0,s_0]) )
    limit(solution)
    step()
    estimator(solution, estimate)
    fem.gridAdapt(markh, persistentDF)

print("final pre adaptive (",i,"): ",dt,grid.size(0),end="\n")
------------------

----- stdout -----
pre adaptive ( 0 ):  240
------------------

[31m---------------------------------------------------------------------------[39m
[31mTypeError[39m                                 Traceback (most recent call last)
[36mCell[39m[36m [39m[32mIn[25][39m[32m, line 9[39m
[32m      7[39m     step()
[32m      8[39m     estimator(solution, estimate)
[32m----> [39m[32m9[39m     [43mfem[49m[43m.[49m[43mgridAdapt[49m[43m([49m[43mmarkh[49m[43m,[49m[43m [49m[43mpersistentDF[49m[43m)[49m
[32m     11[39m [38;5;28mprint[39m([33m"[39m[33mfinal pre adaptive ([39m[33m"[39m,i,[33m"[39m[33m): [39m[33m"[39m,dt,grid.size([32m0[39m),end=[33m"[39m[38;5;130;01m\n[39;00m[33m"[39m)

[36mFile [39m[32m~/DUNE_PYTHON/dune-fem/build-cmake/python/dune/fem/_adaptation.py:201[39m, in [36mgridAdapt[39m[34m(marker, *args)[39m
[32m    198[39m [38;5;28;01mif[39;00m marker [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[32m    199[39m     [38;5;28;01mif[39;00m [38;5;28misinstance[39m(marker, GridMarker):
[32m    200[39m         [38;5;66;03m# GridMarker object using gridView.mark[39;00m
[32m--> [39m[32m201[39m         [43mmarker[49m[43m([49m[43m)[49m
[32m    202[39m     [38;5;28;01melse[39;00m:
[32m    203[39m         [38;5;66;03m# Python or C++ callable[39;00m
[32m    204[39m         hgrid.mark( marker )

[36mFile [39m[32m~/DUNE_PYTHON/dune-fem/build-cmake/python/dune/fem/_adaptation.py:131[39m, in [36mGridMarker.__call__[39m[34m(self)[39m
[32m    128[39m [38;5;28;01mexcept[39;00m [38;5;167;01mAttributeError[39;00m:
[32m    129[39m     [38;5;28;01mraise[39;00m [38;5;167;01mAttributeError[39;00m([33m"[39m[33mindicator function must be over grid view that supports adaptation[39m[33m"[39m)
[32m--> [39m[32m131[39m [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[43m.[49m[43mgridView[49m[43m.[49m[43mmark[49m[43m([49m[43mindicatorGF[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m.[49m[43mrefineTolerance[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m.[49m[43mcoarsenTolerance[49m[43m,[49m
[32m    132[39m [43m                          [49m[38;5;28;43mself[39;49m[43m.[49m[43mminLevel[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m.[49m[43mmaxLevel[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m.[49m[43mminVolume[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m.[49m[43mmaxVolume[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m.[49m[43mmarkNeighbors[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m.[49m[43mstatistics[49m[43m)[49m

[31mTypeError[39m: mark(): incompatible function arguments. The following argument types are supported:
    1. (self: dune.generated.view_220094643888a7089a01c0741f938529.GridView, arg0: Dune::FemPy::VirtualizedGridFunction<Dune::Fem::AdaptiveLeafGridPart<Dune::ALUGrid<2, 2, (Dune::ALUGridElementType)1, (Dune::ALUGridRefinementType)1, Dune::ALUGridMPIComm>, (Dune::PartitionIteratorType)4, false>, Dune::FieldVector<double, 1> >, arg1: float, arg2: float, arg3: int, arg4: int, arg5: float, arg6: float, arg7: bool, arg8: bool) -> tuple[int, int]

Invoked with: LeafGrid with 240 elements, <dune.generated.femspace_ce0f9d88bf70bdad2872b1727d5eaf13_d00091c771f76aab9fb7549784aa86b9.DiscreteFunction object at 0x7958bd185670>, <function <lambda> at 0x7958bd003100>, <function <lambda> at 0x7958bd002340>, 0, 3, -1.0, -1.0, False, False

make: [Makefile:78: twophaseflow_nb.ipynb] Error 1 (ignored)
[jupytext] Reading chimpl.py in format py
[jupytext] Setting kernel python3
[jupytext] Updating notebook metadata with '{"kernelspec": {"name": "python3", "language": "python", "display_name": "Python 3 (ipykernel)"}}'
[jupytext] Executing notebook with kernel python3
Traceback (most recent call last):
  File "/home/dedner/dune-core/lib/python3.12/site-packages/jupyter_core/utils/__init__.py", line 154, in wrapped
    asyncio.get_running_loop()
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/dedner/dune-core/bin/jupytext", line 8, in <module>
    sys.exit(jupytext())
             ^^^^^^^^^^
  File "/home/dedner/dune-core/lib/python3.12/site-packages/jupytext/cli.py", line 497, in jupytext
    exit_code += jupytext_single_file(nb_file, args, log)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dedner/dune-core/lib/python3.12/site-packages/jupytext/cli.py", line 741, in jupytext_single_file
    exec_proc.preprocess(notebook, resources=resources)
  File "/home/dedner/dune-core/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py", line 103, in preprocess
    self.preprocess_cell(cell, resources, index)
  File "/home/dedner/dune-core/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py", line 124, in preprocess_cell
    cell = self.execute_cell(cell, index, store_history=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dedner/dune-core/lib/python3.12/site-packages/jupyter_core/utils/__init__.py", line 158, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/dedner/dune-core/lib/python3.12/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/dedner/dune-core/lib/python3.12/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
t.value = 0
eps.value = 0.05

fig = pyplot.figure(figsize=(30,30))
count = 0
pos = 1
while t.value < 2.15:
    if t.value < 0.6:
        tau.value = 1e-02
    else:
        tau.value = 5e-02
    df_n.assign(df)
    info = scheme.solve(target=df)
    t.value += tau
    count += 1
    if count % 10 == 0:
        df.plot(figure=(fig,330+pos),colorbar=None,clim=[-1,1])
        energy = dune.fem.integrate(Eint(df),order=3)
        print("[",pos,"]",t.value,tau.value,energy,info,flush=True)
        pos += 1
------------------

----- stdout -----
[ 1 ] 0.09999999999999999 0.01 7.478001281489578e+269 {'converged': False, 'iterations': 1, 'linear_iterations': 1, 'timing': [0.407882016, 0.14940081, 0.258481206]}
----- stdout -----
[ 2 ] 0.20000000000000004 0.01 inf {'converged': False, 'iterations': 1, 'linear_iterations': 1, 'timing': [0.391641236, 0.169397895, 0.222243341]}
------------------

[31m---------------------------------------------------------------------------[39m
[31mValueError[39m                                Traceback (most recent call last)
[36mCell[39m[36m [39m[32mIn[6][39m[32m, line 17[39m
[32m     15[39m count += [32m1[39m
[32m     16[39m [38;5;28;01mif[39;00m count % [32m10[39m == [32m0[39m:
[32m---> [39m[32m17[39m     [43mdf[49m[43m.[49m[43mplot[49m[43m([49m[43mfigure[49m[43m=[49m[43m([49m[43mfig[49m[43m,[49m[32;43m330[39;49m[43m+[49m[43mpos[49m[43m)[49m[43m,[49m[43mcolorbar[49m[43m=[49m[38;5;28;43;01mNone[39;49;00m[43m,[49m[43mclim[49m[43m=[49m[43m[[49m[43m-[49m[32;43m1[39;49m[43m,[49m[32;43m1[39;49m[43m][49m[43m)[49m
[32m     18[39m     energy = dune.fem.integrate(Eint(df),order=[32m3[39m)
[32m     19[39m     [38;5;28mprint[39m([33m"[39m[33m[[39m[33m"[39m,pos,[33m"[39m[33m][39m[33m"[39m,t.value,tau.value,energy,info,flush=[38;5;28;01mTrue[39;00m)

[36mFile [39m[32m~/DUNE_PYTHON/dune-fem/build-cmake/python/dune/ufl/__init__.py:666[39m, in [36mGridFunction.__getattr__.<locals>.tocontainer.<locals>.wrapper[39m[34m(*args, **kwargs)[39m
[32m    664[39m [38;5;129m@wraps[39m(func)
[32m    665[39m [38;5;28;01mdef[39;00m[38;5;250m [39m[34mwrapper[39m(*args, **kwargs):
[32m--> [39m[32m666[39m     ret = [43mfunc[49m[43m([49m[43m*[49m[43margs[49m[43m,[49m[43m [49m[43m*[49m[43m*[49m[43mkwargs[49m[43m)[49m
[32m    667[39m     [38;5;28;01mif[39;00m item == [33m"[39m[33mlocalFunction[39m[33m"[39m:
[32m    668[39m         [38;5;28msetattr[39m(ret,[33m"[39m[33mscalar[39m[33m"[39m,[38;5;28mself[39m.scalar)

[36mFile [39m[32m~/DUNE_PYTHON/dune-fem/build-cmake/python/dune/fem/plotting.py:226[39m, in [36mplotPointData[39m[34m(solution, figure, linewidth, level, gridLines, vectors, onlyContours, contours, contourWidth, contourColor, xlim, ylim, clim, cmap, colorbar, grid, triplot, allowNaN, block, logscale, ticks, figsize, gridView, partition)[39m
[32m    224[39m         [38;5;28;01mpass[39;00m
[32m    225[39m     newFig = [38;5;28;01mFalse[39;00m
[32m--> [39m[32m226[39m [43m_plotPointData[49m[43m([49m[43mfigure[49m[43m,[49m[43m [49m[43mgridView[49m[43m,[49m[43m [49m[43msolution[49m[43m,[49m[43m [49m[43mlevel[49m[43m,[49m[43m [49m[43mgridLines[49m[43m,[49m[43m [49m[43mlinewidth[49m[43m,[49m
[32m    227[39m [43m                [49m[43mvectors[49m[43m,[49m[43m [49m[43monlyContours[49m[43m,[49m[43m [49m[43mcontours[49m[43m,[49m[43m [49m[43mcontourWidth[49m[43m,[49m[43m [49m[43mcontourColor[49m[43m,[49m
[32m    228[39m [43m                [49m[43mxlim[49m[43m,[49m[43m [49m[43mylim[49m[43m,[49m[43m [49m[43mclim[49m[43m,[49m[43m [49m[43mcmap[49m[43m,[49m[43m [49m[43mcolorbar[49m[43m,[49m[43m [49m[43mtriplot[49m[43m,[49m
[32m    229[39m [43m                [49m[43mlogscale[49m[43m,[49m[43m [49m[43mticks[49m[43m,[49m[43m [49m[43mallowNaN[49m[43m,[49m
[32m    230[39m [43m                [49m[43mpartition[49m[43m=[49m[43mpartition[49m[43m)[49m
[32m    232[39m [38;5;28;01mif[39;00m newFig [38;5;129;01mand[39;00m block:
[32m    233[39m     pyplot.show(block=block)

[36mFile [39m[32m~/DUNE_PYTHON/dune-fem/build-cmake/python/dune/fem/plotting.py:123[39m, in [36m_plotPointData[39m[34m(fig, grid, solution, level, gridLines, linewidth, vectors, onlyContours, contours, contourWidth, contourColor, xlim, ylim, clim, cmap, colorbar, triplot, logscale, ticks, allowNaN, partition)[39m
[32m    121[39m     maxData = amax(data[np.isfinite(data)])
[32m    122[39m [38;5;28;01melse[39;00m:
[32m--> [39m[32m123[39m     minData = [43mamin[49m[43m([49m[43mdata[49m[43m[[49m[43mnp[49m[43m.[49m[43misfinite[49m[43m([49m[43mdata[49m[43m)[49m[43m][49m[43m)[49m
[32m    124[39m     maxData = amax(data[np.isfinite(data)])
[32m    125[39m     [38;5;28;01massert[39;00m minData == minData [38;5;129;01mand[39;00m maxData == maxData

[36mFile [39m[32m~/dune-core/lib/python3.12/site-packages/numpy/_core/fromnumeric.py:3319[39m, in [36mamin[39m[34m(a, axis, out, keepdims, initial, where)[39m
[32m   3306[39m [38;5;129m@array_function_dispatch[39m(_min_dispatcher)
[32m   3307[39m [38;5;28;01mdef[39;00m[38;5;250m [39m[34mamin[39m(a, axis=[38;5;28;01mNone[39;00m, out=[38;5;28;01mNone[39;00m, keepdims=np._NoValue, initial=np._NoValue,
[32m   3308[39m          where=np._NoValue):
[32m   3309[39m [38;5;250m    [39m[33;03m"""[39;00m
[32m   3310[39m [33;03m    Return the minimum of an array or minimum along an axis.[39;00m
[32m   3311[39m 
[32m   (...)[39m[32m   3317[39m [33;03m    ndarray.min : equivalent method[39;00m
[32m   3318[39m [33;03m    """[39;00m
[32m-> [39m[32m3319[39m     [38;5;28;01mreturn[39;00m [43m_wrapreduction[49m[43m([49m[43ma[49m[43m,[49m[43m [49m[43mnp[49m[43m.[49m[43mminimum[49m[43m,[49m[43m [49m[33;43m'[39;49m[33;43mmin[39;49m[33;43m'[39;49m[43m,[49m[43m [49m[43maxis[49m[43m,[49m[43m [49m[38;5;28;43;01mNone[39;49;00m[43m,[49m[43m [49m[43mout[49m[43m,[49m
[32m   3320[39m [43m                          [49m[43mkeepdims[49m[43m=[49m[43mkeepdims[49m[43m,[49m[43m [49m[43minitial[49m[43m=[49m[43minitial[49m[43m,[49m[43m [49m[43mwhere[49m[43m=[49m[43mwhere[49m[43m)[49m

[36mFile [39m[32m~/dune-core/lib/python3.12/site-packages/numpy/_core/fromnumeric.py:86[39m, in [36m_wrapreduction[39m[34m(obj, ufunc, method, axis, dtype, out, **kwargs)[39m
[32m     83[39m         [38;5;28;01melse[39;00m:
[32m     84[39m             [38;5;28;01mreturn[39;00m reduction(axis=axis, out=out, **passkwargs)
[32m---> [39m[32m86[39m [38;5;28;01mreturn[39;00m [43mufunc[49m[43m.[49m[43mreduce[49m[43m([49m[43mobj[49m[43m,[49m[43m [49m[43maxis[49m[43m,[49m[43m [49m[43mdtype[49m[43m,[49m[43m [49m[43mout[49m[43m,[49m[43m [49m[43m*[49m[43m*[49m[43mpasskwargs[49m[43m)[49m

[31mValueError[39m: zero-size array to reduction operation minimum which has no identity

make: [Makefile:78: chimpl_nb.ipynb] Error 1 (ignored)
